<div class="w-full">
  @if (isLoading) {
    <div class="flex items-center justify-center w-full py-20">
      <span class="text-secondary text-lg">Loading cryptocurrency data...</span>
    </div>
  } @else if (error) {
    <div class="flex items-center justify-center w-full py-20">
      <span class="text-error text-lg">{{ error }}</span>
    </div>
  } @else if (crypto && cryptoDetail) {
    <!-- Main Grid: Left Info Panel + Right Stats -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      
      <!-- Left Column: Info Panel -->
      <div class="space-y-4">
        <!-- Header with Icon, Name, Rank -->
        <div class="rounded-xl p-6">
          <div class="flex items-start gap-4 mb-6">
            <img [src]="crypto.icon" [alt]="crypto.symbol" class="w-16 h-16 rounded-full">
            <div class="flex-1">
              <h1 class="text-2xl font-bold text-white mb-1">{{ crypto.name }} Price ({{ crypto.symbol }})</h1>
              <div class="flex items-center gap-2">
                <span class="text-sm text-primary bg-action/20 px-2 py-1 rounded">Rank #{{ crypto.rank }}</span>
              </div>
            </div>
            <button class="p-2 hover:bg-slate/50 rounded-lg transition-colors">
              <svg class="w-6 h-6 text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                      d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path>
              </svg>
            </button>
          </div>

          <!-- Website -->
          <div class="mb-4">
            <div class="text-sm text-secondary mb-2">Website</div>
            @if (cryptoDetail.links.homepage && cryptoDetail.links.homepage[0]) {
              <a [href]="cryptoDetail.links.homepage[0]" target="_blank" 
                 class="text-action hover:underline flex items-center gap-2 text-sm">
                <svg class="w-4 h-4 text-action" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                </svg>
                <span>{{ cryptoDetail.links.homepage[0].replace('https://', '').replace('http://', '').replace('www.', '') }}</span>
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                </svg>
              </a>
            } @else {
              <span class="text-secondary text-sm">N/A</span>
            }
          </div>

          <!-- Community -->
          <div class="mb-4">
            <div class="text-sm text-secondary mb-2">Community</div>
            <div class="flex flex-wrap gap-2">
              @if (cryptoDetail.links.twitter_screen_name) {
                <a [href]="'https://twitter.com/' + cryptoDetail.links.twitter_screen_name" target="_blank"
                   class="flex items-center gap-1 px-2 py-1 text-xs bg-slate/50 hover:bg-slate rounded text-primary transition-colors">
                  <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 24 24"><path d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z"></path></svg>
                  Twitter
                </a>
              }
              @if (cryptoDetail.links.subreddit_url) {
                <a [href]="cryptoDetail.links.subreddit_url" target="_blank"
                   class="flex items-center gap-1 px-2 py-1 text-xs bg-slate/50 hover:bg-slate rounded text-primary transition-colors">
                  <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"></path></svg>
                  Reddit
                </a>
              }
              @if (cryptoDetail.links.telegram_channel_identifier) {
                <a [href]="'https://t.me/' + cryptoDetail.links.telegram_channel_identifier" target="_blank"
                   class="flex items-center gap-1 px-2 py-1 text-xs bg-slate/50 hover:bg-slate rounded text-primary transition-colors">
                  <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 24 24"><path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"></path></svg>
                  Telegram
                </a>
              }
            </div>
          </div>

          <!-- Explorers -->
          <div class="mb-4">
            <div class="text-sm text-secondary mb-2">Explorers</div>
            <div class="flex flex-wrap gap-2">
              @for (explorer of cryptoDetail.links.blockchain_site.slice(0, 4); track explorer) {
                @if (explorer) {
                  <a [href]="explorer" target="_blank"
                     class="px-2 py-1 text-xs bg-slate/50 hover:bg-slate rounded text-primary transition-colors">
                    {{ getExplorerName(explorer) }}
                  </a>
                }
              }
            </div>
          </div>

          <!-- Contract -->
          @if (getContractAddress()) {
            <div>
              <div class="text-sm text-secondary mb-2">Contract</div>
              <div class="flex items-center gap-2 bg-slate/30 rounded px-3 py-2">
                <span class="text-warning text-xs">⚠️</span>
                <code class="text-secondary font-mono text-xs flex-1">{{ shortenAddress(getContractAddress()!) }}</code>
                <button class="text-secondary hover:text-action transition-colors p-1"
                        (click)="copyToClipboard(getContractAddress()!)"
                        title="Copy address">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                  </svg>
                </button>
              </div>
            </div>
          }
        </div>
      </div>

      <!-- Right Column: Price & Stats -->
      <div class="space-y-4">
        <!-- Price Card -->
        <div class="p-6">
          <div class="text-sm text-secondary mb-2">{{ crypto.name }} Price ({{ crypto.symbol }})</div>
          <div class="flex items-baseline gap-3 mb-2">
            <div class="text-4xl font-bold text-action">${{ crypto.price | number : '1.2-2' }}</div>
            <div class="text-sm text-secondary">{{ crypto.price / 1 | number : '1.8-8' }} BTC</div>
          </div>
          <div [class]="crypto.change24h >= 0 ? 'inline-flex items-center gap-1 px-2 py-1 rounded bg-action/20 text-action' : 'inline-flex items-center gap-1 px-2 py-1 rounded bg-error/20 text-error'">
            <span class="text-xs font-semibold">{{ crypto.change24h >= 0 ? '+' : '' }}{{ crypto.change24h | number : '1.2-2' }}%</span>
          </div>
        </div>

        <!-- Stats Grid -->
        <div class="p-6">
          <div class="grid grid-cols-2 gap-4">
            <div>
              <div class="flex items-center gap-1 text-xs text-secondary mb-1">
                <span>Market Cap</span>
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
              </div>
              <div class="text-primary font-semibold">${{ crypto.marketCap / 1000000000 | number : '1.2-2' }}B</div>
            </div>

            <div>
              <div class="flex items-center gap-1 text-xs text-secondary mb-1">
                <span>Circulating Supply</span>
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
              </div>
              <div class="text-primary font-semibold">{{ crypto.circulatingSupply | number : '1.0-0' }}</div>
            </div>

            <div>
              <div class="flex items-center gap-1 text-xs text-secondary mb-1">
                <span>Volume 24h</span>
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
              </div>
              <div class="text-primary font-semibold">${{ crypto.volume24h / 1000000000 | number : '1.2-2' }}B</div>
            </div>

            <div>
              <div class="flex items-center gap-1 text-xs text-secondary mb-1">
                <span>Total Supply</span>
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
              </div>
              <div class="text-primary font-semibold">{{ crypto.totalSupply ? (crypto.totalSupply | number : '1.0-0') : 'N/A' }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  }
</div>
